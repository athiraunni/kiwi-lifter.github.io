function initMap(e){var n,a=[{featureType:"all",elementType:"all",stylers:[{saturation:-100},{gamma:.5}]}],o=new google.maps.StyledMapType(a,{name:"Restaurants"}),t={mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"map_style"]}};n=new google.maps.Map(document.getElementById("map"),t),n.mapTypes.set("map_style",o),n.setMapTypeId("map_style");var r,i,l,p,s,m=e.restaurants,u=new google.maps.InfoWindow,g=new google.maps.LatLngBounds;for(i=0;i<m.length;i++)l=m[i].location,p=m[i].name,s={url:"resources/images/marker-orange.png",scaledSize:new google.maps.Size(35,35)},r=new google.maps.Marker({map:n,position:l,title:p,animation:google.maps.Animation.DROP,id:i,icon:s}),m[i].marker=r,g.extend(m[i].marker.position);var c,f,d=function(e){$.ajax(f).done(function(n){m[e].marker.yelpInfo=n,m[e].marker.addListener("click",function(){populateInfoWindow(this,u),markerBounce(this)})}).fail(function(){$("#danger").show()})};for(c=0;c<m.length;c++)f=getYelpInfo(m[c]),d(c);n.fitBounds(g),window.onresize=function(){n.fitBounds(g)}}function markerBounce(e){e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1400)}function populateInfoWindow(e,n){n.marker!=e&&(n.marker=e,n.setContent('<div class="marker-info-panel"><h4>'+e.yelpInfo.name+"</h4><p>"+e.yelpInfo.location.address[0]+'</p><a href="'+e.yelpInfo.mobile_url+'" target="_blank"><img src="'+e.yelpInfo.image_url+'" alt="Yelp restaurant image." ></a><p>Ph: '+e.yelpInfo.display_phone+"</p></div>"),n.open(map,e),n.addListener("closeclick",function(){n.marker=null}))}function generateNonce(){return Math.floor(1e12*Math.random()).toString()}function getYelpInfo(e){var n=""+e.web,a="_2Ah0MhfqD-6bTRas90k-g",o="iPD6CD5VbxITVXljAxqNFbksMf7f4z6C",t="4tvw4xVA9rF-ERUfxIO35I6E0Lo",r="GaSqIVTr_yhTgPTnabngJCvOAy8",i=n,l={oauth_consumer_key:a,oauth_token:o,oauth_nonce:generateNonce(),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",callback:"cb",location:i},p=oauthSignature.generate("GET",i,l,t,r);l.oauth_signature=p;var s={url:i,data:l,cache:!0,dataType:"jsonp"};return s}