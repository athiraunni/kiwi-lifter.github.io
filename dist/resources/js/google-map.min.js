function initMap(){var e,a=[{featureType:"all",elementType:"all",stylers:[{saturation:-100},{gamma:.5}]}],n=new google.maps.StyledMapType(a,{name:"Restaurants"}),o={mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"map_style"]}};e=new google.maps.Map(document.getElementById("map"),o),e.mapTypes.set("map_style",n),e.setMapTypeId("map_style");var t,r,i,l,p,s=appData.restaurants,m=new google.maps.InfoWindow,u=new google.maps.LatLngBounds;for(r=0;r<s.length;r++)i=s[r].location,l=s[r].name,p={url:"resources/images/marker-orange.png",scaledSize:new google.maps.Size(35,35)},t=new google.maps.Marker({map:e,position:i,title:l,animation:google.maps.Animation.DROP,id:r,icon:p}),s[r].marker=t,u.extend(s[r].marker.position);var g,c,f=function(e){$.ajax(c).done(function(a){s[e].marker.yelpInfo=a,s[e].marker.addListener("click",function(){populateInfoWindow(this,m),markerBounce(this)})}).fail(function(){$("#danger").show()})};for(g=0;g<s.length;g++)c=getYelpInfo(s[g]),f(g);e.fitBounds(u)}function markerBounce(e){e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1450)}function populateInfoWindow(e,a){a.marker!=e&&(a.marker=e,a.setContent('<div class="markerInfoPanel"><h4>'+e.yelpInfo.name+"</h4><p>"+e.yelpInfo.location.address[0]+'</p><a href="'+e.yelpInfo.mobile_url+'"><img src="'+e.yelpInfo.image_url+'" alt="Yelp restaurant image."></a><p>Ph: '+e.yelpInfo.display_phone+"</p></div>"),a.open(map,e),a.addListener("closeclick",function(){a.marker=null}))}function generateNonce(){return Math.floor(1e12*Math.random()).toString()}function getYelpInfo(e){var a=""+e.web,n="_2Ah0MhfqD-6bTRas90k-g",o="iPD6CD5VbxITVXljAxqNFbksMf7f4z6C",t="4tvw4xVA9rF-ERUfxIO35I6E0Lo",r="GaSqIVTr_yhTgPTnabngJCvOAy8",i=a,l={oauth_consumer_key:n,oauth_token:o,oauth_nonce:generateNonce(),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",callback:"cb",location:i},p=oauthSignature.generate("GET",i,l,t,r);l.oauth_signature=p;var s={url:i,data:l,cache:!0,dataType:"jsonp",success:function(){},fail:function(){}};return s}