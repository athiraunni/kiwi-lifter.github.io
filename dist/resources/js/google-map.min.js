function initMap(e){var a,n=[{featureType:"all",elementType:"all",stylers:[{saturation:-100},{gamma:.5}]}],o=new google.maps.StyledMapType(n,{name:"Restaurants"}),t={mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"map_style"]}};a=new google.maps.Map(document.getElementById("map"),t),a.mapTypes.set("map_style",o),a.setMapTypeId("map_style");var r,i,l,s,p,m=e.restaurants,u=new google.maps.InfoWindow,g=new google.maps.LatLngBounds;for(i=0;i<m.length;i++)l=m[i].location,s=m[i].name,p={url:"resources/images/marker-orange.png",scaledSize:new google.maps.Size(35,35)},r=new google.maps.Marker({map:a,position:l,title:s,animation:google.maps.Animation.DROP,id:i,icon:p}),m[i].marker=r,g.extend(m[i].marker.position);var c,f,d=function(e){$.ajax(f).done(function(a){m[e].marker.yelpInfo=a,m[e].marker.addListener("click",function(){populateInfoWindow(this,u),markerBounce(this)})}).fail(function(){$("#danger").show()})};for(c=0;c<m.length;c++)f=getYelpInfo(m[c]),d(c);a.fitBounds(g)}function markerBounce(e){e.setAnimation(google.maps.Animation.BOUNCE),setTimeout(function(){e.setAnimation(null)},1450)}function populateInfoWindow(e,a){a.marker!=e&&(a.marker=e,a.setContent('<div class="markerInfoPanel"><h4>'+e.yelpInfo.name+"</h4><p>"+e.yelpInfo.location.address[0]+'</p><a href="'+e.yelpInfo.mobile_url+'" target="_blank"><img src="'+e.yelpInfo.image_url+'" alt="Yelp restaurant image." ></a><p>Ph: '+e.yelpInfo.display_phone+"</p></div>"),a.open(map,e),a.addListener("closeclick",function(){a.marker=null}))}function generateNonce(){return Math.floor(1e12*Math.random()).toString()}function getYelpInfo(e){var a=""+e.web,n="_2Ah0MhfqD-6bTRas90k-g",o="iPD6CD5VbxITVXljAxqNFbksMf7f4z6C",t="4tvw4xVA9rF-ERUfxIO35I6E0Lo",r="GaSqIVTr_yhTgPTnabngJCvOAy8",i=a,l={oauth_consumer_key:n,oauth_token:o,oauth_nonce:generateNonce(),oauth_timestamp:Math.floor(Date.now()/1e3),oauth_signature_method:"HMAC-SHA1",oauth_version:"1.0",callback:"cb",location:i},s=oauthSignature.generate("GET",i,l,t,r);l.oauth_signature=s;var p={url:i,data:l,cache:!0,dataType:"jsonp",success:function(){},fail:function(){}};return p}